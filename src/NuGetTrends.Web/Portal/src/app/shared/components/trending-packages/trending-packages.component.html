<section class="section trending-section">
  <div class="container">
    <h2 class="title is-4 has-text-centered">Trending This Week</h2>
    <p class="subtitle is-6 has-text-centered">Rising NuGet packages based on week-over-week download growth</p>

    <!-- Loading state -->
    <div *ngIf="isLoading" class="has-text-centered">
      <p class="is-size-6 has-text-grey">Loading trending packages...</p>
    </div>

    <!-- Error state -->
    <div *ngIf="errorMessage && !isLoading" class="notification is-warning is-light">
      <p>{{ errorMessage }}</p>
    </div>

    <!-- Empty state -->
    <div *ngIf="!isLoading && !errorMessage && trendingPackages.length === 0" class="has-text-centered">
      <p class="is-size-6 has-text-grey">No trending packages found.</p>
    </div>

    <!-- Trending packages list -->
    <div *ngIf="!isLoading && !errorMessage && trendingPackages.length > 0" class="trending-list">
      <div
        *ngFor="let package of trendingPackages; let i = index"
        class="trending-item"
        (click)="navigateToPackage(package.packageId)"
        tabindex="0"
        role="button"
        [attr.aria-label]="'View details for ' + package.packageId"
        (keydown.enter)="navigateToPackage(package.packageId)"
        (keydown.space)="navigateToPackage(package.packageId)">

        <div class="trending-item-content">
          <div class="trending-rank">{{ i + 1 }}</div>

          <figure class="trending-icon">
            <img [src]="package.iconUrl" [alt]="package.packageId + ' icon'" loading="lazy">
          </figure>

          <div class="trending-info">
            <p class="trending-name">{{ package.packageId }}</p>
            <p class="trending-downloads">
              <span class="has-text-weight-semibold">{{ formatDownloadCount(package.downloadCount) }}</span>
              <span class="downloads-label"> downloads/week</span>
            </p>
          </div>

          <div class="trending-growth" [ngClass]="getGrowthClass(package.growthRate)">
            {{ formatGrowthRate(package.growthRate) }}
          </div>

          <div class="trending-actions">
            <button
              class="button"
              title="View on NuGet.org"
              (click)="openNuGetPage(package.packageId); $event.stopPropagation()">
              <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 512 512" fill="currentColor">
                  <path d="M400 32H112C67.8 32 32 67.8 32 112v288c0 44.2 35.8 80 80 80h288c44.2 0 80-35.8 80-80V112c0-44.2-35.8-80-80-80zM178.6 409.6c-52.4 0-94.8-42.5-94.8-94.8s42.5-94.8 94.8-94.8 94.8 42.5 94.8 94.8-42.4 94.8-94.8 94.8zm46.5-224.8c-36.1 0-65.4-29.3-65.4-65.4s29.3-65.4 65.4-65.4 65.4 29.3 65.4 65.4-29.3 65.4-65.4 65.4zm158.8 131.6c-47.8 0-86.6-38.8-86.6-86.6s38.8-86.6 86.6-86.6 86.6 38.8 86.6 86.6-38.8 86.6-86.6 86.6z"/>
                </svg>
              </span>
            </button>
            <a
              *ngIf="package.gitHubUrl"
              [href]="package.gitHubUrl"
              target="_blank"
              rel="noopener noreferrer"
              class="button"
              title="View on GitHub"
              (click)="$event.stopPropagation()">
              <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
              </span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
